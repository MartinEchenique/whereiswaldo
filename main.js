!function(e){var t={};function s(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";async function n(e){if(e)document.getElementById("timeFormFrame").style.display="flex";else{a(await async function(){const e=fbFunctions.httpsCallable("getTopTenTable");return(await e()).data}()),document.getElementById("topTenDiv").style.display="flex"}}function a(e){const t=document.getElementById("topTenTable");e.forEach(e=>{const s=document.createElement("li");s.textContent="second: "+Math.floor(e.time/1e3)+","+e.time%1e3+" name: "+e.name,t.appendChild(s)})}s.r(t);class o{constructor(e,t,s={}){this.matchId=t,this.personages=s,this.img=this.createDomElement(e),this.setFirsSelected()}addPersonage(e){this.personages={...this.personage,personage:e}}setFirsSelected(){this.personages[document.getElementsByClassName("toFindImg")[0].dataset.name].selectImg.setAsSelected()}createDomElement(e){let t=document.getElementById("tagged-image"),s=document.createElement("img");return s.src=e,s.draggable="false",s.setAttribute("id","WhereIsWallyImg"),s.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.handleImgClick(e)}),t.appendChild(s),s}async handleImgClick(e){let t=e.offsetX,s=e.offsetY;document.getElementsByClassName("selected")[0]||this.personages[document.getElementsByClassName("toFindImg")[0].dataset.name].selectImg.setAsSelected();let n=document.getElementsByClassName("selected")[0].dataset.name;const a=this.personages[n];a.canMoveTag()&&(a.setCoordinates(s,t),this.handleFound(n,t,s))}async handleFound(e,t,s){const a=this.personages[e];let o=await async function(e,t,s){const n=fbFunctions.httpsCallable("checkPersonage");let a;return await n({name:e,coordinates:t,id:s}).then(e=>{a=e}),a.data}(e,[t,s],this.matchId);console.log(o.data),o.data?(a.setAsFound(),this.defineSelect(),this.checkForWin()&&n(o.isTopTen)):a.notFound()}defineSelect(){for(const e in this.personages)if(this.personages.hasOwnProperty(e)&&!this.personages[e].isFound()){this.personages[e].setAsSelected();break}}checkForWin(){let e=!0;for(const t in this.personages)this.personages.hasOwnProperty(t)&&(this.personages[t].isFound()||(e=!1));return e}}class l{constructor(e){this.borderElement=this.createBorderElement(),this.domElement=this.createDomElement(e),this.visible=!1}setTop(e,t=!0){this.domElement.style.top=e-25+"px",this.borderElement.style.top=e-25+"px"}setLeft(e,t=!0){this.domElement.style.left=e-25+"px",this.borderElement.style.left=e-25+"px"}setPlace(e,t){this.visible||(this.visible=!0,this.domElement.style.display="block",this.borderElement.style.display="block"),this.borderElement.setAttribute("class","tagBorder loader"),this.setTop(e),this.setLeft(t)}setAsFound(){this.borderElement.setAttribute("class","tagBorder foundTag")}setAsNotFound(){this.borderElement.setAttribute("class","tagBorder noFoundTag"),setTimeout(()=>{this.domElement.style.display="none",this.borderElement.style.display="none",this.borderElement.setAttribute("class","tagBorder"),this.visible=!1},800)}canMove(){return!this.borderElement.classList.contains("noFoundTag")&&!this.borderElement.classList.contains("foundTag")&&!this.borderElement.classList.contains("loader")}createDomElement(e){let t=document.getElementById("tagged-image"),s=document.createElement("img");return s.style.position="absolute",s.src=e,s.style.display="none",s.classList.add("tag-img"),t.appendChild(s),s}createBorderElement(){let e=document.getElementById("tagged-image"),t=document.createElement("div");return t.style.position="absolute",t.style.display="none",e.appendChild(t),t}}class i{constructor(e,t,s=null,n=null){this.setAsSelected=this.setAsSelected.bind(this),this.domElement=this.createDomElement(t,e)}setAsSelected(){let e=document.getElementsByClassName("selected")[0];e&&e.classList.remove("selected"),this.domElement.classList.add("selected")}createDomElement(e,t){let s=document.getElementById("faces-container"),n=document.createElement("img");return n.src=t,n.classList.add("toFindImg"),n.dataset.name=e,n.addEventListener("click",this.setAsSelected),s.appendChild(n),n}setAsFound(){this.domElement.classList.add("found"),this.domElement.removeEventListener("click",this.setAsSelected),this.domElement.classList.remove("selected")}}class d{constructor(e,t){this.name=e,this.img=t,this.found=!1,this.coordinates=[null,null],this.tag=new l(t),this.selectImg=new i(t,e)}setCoordinates(e,t){this.tag.canMove()&&(this.coordinates=[e,t],this.tag.setPlace(e,t))}canMoveTag(){return this.tag.canMove()}setAsFound(){this.found=!0,this.selectImg.setAsFound(),this.tag.setAsFound()}isFound(){return this.found}notFound(){this.tag.setAsNotFound()}setAsSelected(){this.selectImg.setAsSelected()}}window.onload=async()=>{const e=fbFunctions.httpsCallable("newMatch"),t=(await e({personages:["wally","odlaw","wizard"]})).data;let s=new d("wally","../src/wally.png"),n=new d("odlaw","../src/odlaw.jpg"),l=new d("wizard","../src/wizard.png");new o("../src/whereWaldo.jpg",t,{wally:s,odlaw:n,wizard:l});var i;i=t,document.getElementById("timeGame").addEventListener("submit",async e=>{e.preventDefault(),e.submitter.disabled=!0;const t=document.getElementById("timeName").value,s=fbFunctions.httpsCallable("addToTimesTable");let n=await s({id:i,name:t});e.target.parentElement.style.display="none",a(n.data),document.getElementById("topTenDiv").style.display="flex"})}}]);